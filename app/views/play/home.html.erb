<% content_for(:title) { "#{@group.name} - GGame" } %>

<div class="header">
  <h1>ğŸ® GGame</h1>
  <div class="group-name"><%= @group.name %></div>
</div>

<div class="content">
  <div class="card">
    <h2>ğŸ‘‹ Willkommen!</h2>
    <p style="color: rgba(255,255,255,0.7); margin-bottom: 10px;">
      <% if @session.player_name.present? %>
        Hallo <strong><%= @session.player_name %></strong>!
      <% else %>
        Du bist Mitglied von <strong><%= @group.name %></strong>.
      <% end %>
    </p>
    <p style="color: rgba(255,255,255,0.5); font-size: 0.9rem;">
      Punkte: <strong style="color: #4CAF50;"><%= @group.player_visible_points || 0 %></strong>
    </p>
  </div>

  <!-- Primary Action: Submit -->
  <a href="<%= play_submit_path %>" class="btn btn-submit">
    ğŸ“¤ Aktion einreichen
  </a>

  <a href="<%= play_my_submissions_path %>" class="btn btn-secondary">
    ğŸ“‹ Meine Einreichungen
    <% pending_count = @session.submissions.pending.count %>
    <% if pending_count > 0 %>
      <span class="badge"><%= pending_count %></span>
    <% end %>
  </a>

  <a href="<%= play_targets_path %>" class="btn btn-primary">
    ğŸ¯ Posten ansehen
  </a>
  
  <a href="<%= play_rules_path %>" class="btn btn-secondary">
    ğŸ“œ Spielregeln
  </a>
  
  <div style="margin-top: 30px; text-align: center;">
    <a href="<%= play_logout_path %>" data-method="delete" class="btn btn-danger" style="width: auto; display: inline-block; padding: 10px 20px; font-size: 0.9rem;"
       onclick="if(!confirm('Wirklich abmelden?')) return false; localStorage.removeItem('ggame_session_token'); localStorage.removeItem('ggame_group_name');">
      ğŸšª Abmelden
    </a>
  </div>
</div>

<!-- Bottom Navigation -->
<nav class="nav-menu">
  <a href="<%= play_home_path %>" class="nav-item active">
    <span class="icon">ğŸ </span>
    <span>Home</span>
  </a>
  <a href="<%= play_submit_path %>" class="nav-item">
    <span class="icon">ğŸ“¤</span>
    <span>Einreichen</span>
  </a>
  <a href="<%= play_targets_path %>" class="nav-item">
    <span class="icon">ğŸ¯</span>
    <span>Posten</span>
  </a>
  <a href="<%= play_rules_path %>" class="nav-item">
    <span class="icon">ğŸ“œ</span>
    <span>Regeln</span>
  </a>
</nav>

<style>
  .btn-submit {
    background: linear-gradient(135deg, #00b894, #00cec9) !important;
    font-size: 1.2rem !important;
    padding: 18px !important;
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.02); }
  }
  
  .badge {
    background: #e74c3c;
    color: white;
    font-size: 0.75rem;
    padding: 2px 8px;
    border-radius: 10px;
    margin-left: 8px;
  }
</style>

<script>
  // Keep session alive
  setInterval(() => {
    const token = localStorage.getItem('ggame_session_token');
    if (token) {
      fetch('/api/player_sessions/update_activity', {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content
        },
        body: JSON.stringify({ session_token: token })
      });
    }
  }, 5 * 60 * 1000); // Every 5 minutes
</script>
